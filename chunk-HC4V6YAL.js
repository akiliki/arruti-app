import{a as W,c as q,e as g,h as G,k as J,l as K,m as Q,o as U}from"./chunk-EMFWQ2AM.js";import{a as V}from"./chunk-GMV6DHHB.js";import{$ as f,C as a,H as s,I as w,J as l,M as t,N as e,O as x,T as L,U as b,V as n,W as c,X as C,Z as k,_ as $,aa as D,ba as h,ca as v,d as S,h as M,i as O,ia as N,ja as z,ka as T,l as m,la as A,m as y,ma as R,na as B,s as I,t as F,va as j,xa as H}from"./chunk-7CFEW4HV.js";var ne=o=>["/pedidos",o,"estado"];function ie(o,r){if(o&1&&(t(0,"tr")(1,"td"),n(2),e(),t(3,"td"),n(4),e(),t(5,"td"),n(6),e(),t(7,"td"),n(8),f(9,"date"),e(),t(10,"td")(11,"span",18),n(12),e()(),t(13,"td",19),n(14),f(15,"date"),e(),t(16,"td")(17,"button",20),n(18," Cambiar Estado "),e()()()),o&2){let i=r.$implicit;w("data-testid","pedido-row-"+i.id),a(2),c(i.id),a(2),c(i.producto),a(2),c(i.cantidad),a(2),c(h(9,9,i.fechaEntrega,"dd/MM/yyyy")),a(3),l("ngClass",i.estado.toLowerCase().replace(" ","-")),a(),C(" ",i.estado," "),a(2),C(" ",i.fechaActualizacion?h(15,12,i.fechaActualizacion,"dd/MM HH:mm"):"-"," "),a(3),l("routerLink",$(15,ne,i.id))}}function oe(o,r){if(o&1&&(t(0,"table")(1,"thead")(2,"tr")(3,"th"),n(4,"ID"),e(),t(5,"th"),n(6,"Producto"),e(),t(7,"th"),n(8,"Cantidad"),e(),t(9,"th"),n(10,"Fecha Entrega"),e(),t(11,"th"),n(12,"Estado"),e(),t(13,"th"),n(14,"\xDAltima Act."),e(),t(15,"th"),n(16,"Acciones"),e()()(),t(17,"tbody"),s(18,ie,19,17,"tr",17),e()()),o&2){let i=L().ngIf;a(18),l("ngForOf",i)}}function re(o,r){o&1&&(t(0,"div",21),n(1,"No se encontraron pedidos con los filtros seleccionados."),e())}function ae(o,r){if(o&1&&(t(0,"div",15),s(1,oe,19,1,"table",16)(2,re,2,0,"ng-template",null,1,v),e()),o&2){let i=r.ngIf,d=b(3);a(),l("ngIf",i.length>0)("ngIfElse",d)}}function de(o,r){o&1&&(t(0,"div",22),n(1,"Cargando pedidos..."),e())}var X=class o{productionService=I(V);estadoFilter=new g("");productoFilter=new g("");fechaFilter=new g("");refresh$=new S(void 0);updatingId=null;filteredPedidos$;ngOnInit(){let r=this.refresh$.pipe(y(()=>this.productionService.getPedidos())),i=this.estadoFilter.valueChanges.pipe(m("")),d=this.productoFilter.valueChanges.pipe(m("")),p=this.fechaFilter.valueChanges.pipe(m(""));this.filteredPedidos$=O([r,i,d,p]).pipe(M(([Y,_,P,E])=>Y.filter(u=>{let Z=!_||u.estado===_,ee=!P||u.producto.toLowerCase().includes(P.toLowerCase()),te=!E||this.formatDate(u.fechaEntrega)===E;return Z&&ee&&te})))}onStatusChange(r,i){let d=i.target.value;this.updatingId=r,this.productionService.updatePedidoStatus(r,d).subscribe({next:()=>{this.updatingId=null,this.refresh$.next()},error:p=>{alert(p.message),this.updatingId=null,this.refresh$.next()}})}formatDate(r){return r.toISOString().split("T")[0]}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=F({type:o,selectors:[["app-pedidos-list"]],standalone:!0,features:[k],decls:31,vars:7,consts:[["loading",""],["empty",""],[1,"list-container"],[1,"header"],["routerLink","/nuevo-pedido",1,"btn-new"],[1,"filters"],[1,"filter-group"],[3,"formControl"],["value",""],["value","Pendiente"],["value","En Proceso"],["value","Finalizado"],["type","text","placeholder","Filtrar por producto...",3,"formControl"],["type","date",3,"formControl"],["class","table-wrapper",4,"ngIf","ngIfElse"],[1,"table-wrapper"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],[1,"badge",3,"ngClass"],[1,"timestamp"],[1,"btn-action",3,"routerLink"],[1,"empty-state"],[1,"loading-state"]],template:function(i,d){if(i&1&&(t(0,"div",2)(1,"div",3)(2,"h2"),n(3,"Lista de Pedidos"),e(),t(4,"button",4),n(5,"Nuevo Pedido"),e()(),t(6,"div",5)(7,"div",6)(8,"label"),n(9,"Estado:"),e(),t(10,"select",7)(11,"option",8),n(12,"Todos"),e(),t(13,"option",9),n(14,"Pendiente"),e(),t(15,"option",10),n(16,"En Proceso"),e(),t(17,"option",11),n(18,"Finalizado"),e()()(),t(19,"div",6)(20,"label"),n(21,"Producto:"),e(),x(22,"input",12),e(),t(23,"div",6)(24,"label"),n(25,"Fecha:"),e(),x(26,"input",13),e()(),s(27,ae,4,2,"div",14),f(28,"async"),s(29,de,2,0,"ng-template",null,0,v),e()),i&2){let p=b(30);a(10),l("formControl",d.estadoFilter),a(12),l("formControl",d.productoFilter),a(4),l("formControl",d.fechaFilter),a(),l("ngIf",D(28,5,d.filteredPedidos$))("ngIfElse",p)}},dependencies:[B,N,z,T,A,R,U,K,Q,W,J,q,G,H,j],styles:[".list-container[_ngcontent-%COMP%]{padding:20px}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.btn-new[_ngcontent-%COMP%]{background:#d35400;color:#fff;border:none;padding:10px 20px;border-radius:4px;cursor:pointer;font-weight:700}.filters[_ngcontent-%COMP%]{display:flex;gap:20px;margin-bottom:20px;background:#f9f9f9;padding:15px;border-radius:8px}.filter-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:5px}.filter-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.9rem;font-weight:700}.filter-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:8px;border:1px solid #ccc;border-radius:4px}.table-wrapper[_ngcontent-%COMP%]{background:#fff;border:1px solid #ddd;border-radius:8px;overflow:hidden}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}th[_ngcontent-%COMP%]{text-align:left;background:#f4f4f4;padding:12px;border-bottom:2px solid #ddd}td[_ngcontent-%COMP%]{padding:12px;border-bottom:1px solid #eee}.timestamp[_ngcontent-%COMP%]{font-size:.8rem;color:#666}.badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:.8rem;font-weight:700}.badge.pendiente[_ngcontent-%COMP%]{background:#fff3cd;color:#856404}.badge.en-proceso[_ngcontent-%COMP%]{background:#cce5ff;color:#004085}.badge.finalizado[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.loading-state[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]{padding:40px;text-align:center;color:#666}.btn-action[_ngcontent-%COMP%]{background:#34495e;color:#fff;border:none;padding:6px 12px;border-radius:4px;cursor:pointer;font-size:.85rem}.btn-action[_ngcontent-%COMP%]:hover{background:#2c3e50}"]})};export{X as PedidosListComponent};
