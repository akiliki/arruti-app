import{a as I,b as g,c as O,d as y,f as R,i as N,j as k,n as w,o as D}from"./chunk-F5WL7XU5.js";import{a as j}from"./chunk-ZO7HK4OT.js";import"./chunk-ORCUSZZD.js";import{Aa as E,Da as F,F as l,K as c,M as s,P as i,Q as o,R as p,V as v,W as h,Y as n,Z as P,_ as f,ba as C,pa as M,sa as _,t as m,u as b,xa as x,za as S}from"./chunk-ALWVHIEC.js";function G(a,r){a&1&&(i(0,"div",12),n(1," La familia es obligatoria. "),o())}function T(a,r){a&1&&(i(0,"div",12),n(1," El nombre es obligatorio. "),o())}function V(a,r){if(a&1&&(i(0,"div",13),n(1),o()),a&2){let t=h();l(),f(" ",t.errorMessage," ")}}var z=class a{fb=m(w);productoService=m(j);router=m(S);route=m(x);isSubmitting=!1;isEditMode=!1;productId=null;errorMessage="";productForm=this.fb.group({familia:["",g.required],producto:["",g.required],tallasRaciones:[""]});ngOnInit(){this.productId=this.route.snapshot.paramMap.get("id"),this.productId&&(this.isEditMode=!0,this.loadProducto(this.productId))}loadProducto(r){this.productoService.getProductoById(r).subscribe(t=>{t?this.productForm.patchValue({familia:t.familia,producto:t.producto,tallasRaciones:t.tallasRaciones.join(", ")}):this.errorMessage="Producto no encontrado."})}onSubmit(){if(this.productForm.invalid)return;this.isSubmitting=!0,this.errorMessage="";let r=this.productForm.value,t=r.tallasRaciones?r.tallasRaciones.split(",").map(e=>e.trim()).filter(e=>e!==""):[];if(this.isEditMode&&this.productId){let e={id:this.productId,familia:r.familia||"",producto:r.producto||"",tallasRaciones:t};this.productoService.updateProducto(e).subscribe({next:()=>this.router.navigate(["/productos"]),error:d=>{this.isSubmitting=!1,this.errorMessage=d.message||"Error al actualizar el producto."}})}else{let e={familia:r.familia||"",producto:r.producto||"",tallasRaciones:t};this.productoService.addProducto(e).subscribe({next:()=>this.router.navigate(["/productos"]),error:d=>{this.isSubmitting=!1,this.errorMessage=d.message||"Error al guardar el producto."}})}}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=b({type:a,selectors:[["app-producto-form"]],standalone:!0,features:[C],decls:27,vars:7,consts:[[1,"form-container"],[1,"header"],["routerLink","/productos",1,"btn-back"],[1,"card",3,"ngSubmit","formGroup"],[1,"field"],["type","text","formControlName","familia","placeholder","Ej: Boller\xEDa, Pasteler\xEDa, Panes..."],["class","error",4,"ngIf"],["type","text","formControlName","producto","placeholder","Ej: Croissant de Mantequilla"],["type","text","formControlName","tallasRaciones","placeholder","Ej: Individual, 4p, 6p (separados por comas)"],[1,"actions"],["type","submit",1,"btn-save",3,"disabled"],["class","error-box",4,"ngIf"],[1,"error"],[1,"error-box"]],template:function(t,e){if(t&1&&(i(0,"div",0)(1,"div",1)(2,"h2"),n(3),o(),i(4,"button",2),n(5,"Volver"),o()(),i(6,"form",3),v("ngSubmit",function(){return e.onSubmit()}),i(7,"div",4)(8,"label"),n(9,"Familia"),o(),p(10,"input",5),c(11,G,2,0,"div",6),o(),i(12,"div",4)(13,"label"),n(14,"Nombre del Producto"),o(),p(15,"input",7),c(16,T,2,0,"div",6),o(),i(17,"div",4)(18,"label"),n(19,"Raciones / Tama\xF1os (opcional)"),o(),p(20,"input",8),i(21,"small"),n(22,"Si hay varios, sep\xE1relos por comas."),o()(),i(23,"div",9)(24,"button",10),n(25),o()(),c(26,V,2,1,"div",11),o()()),t&2){let d,u;l(3),P(e.isEditMode?"Editar Producto":"A\xF1adir Nuevo Producto"),l(3),s("formGroup",e.productForm),l(5),s("ngIf",((d=e.productForm.get("familia"))==null?null:d.touched)&&((d=e.productForm.get("familia"))==null?null:d.invalid)),l(5),s("ngIf",((u=e.productForm.get("producto"))==null?null:u.touched)&&((u=e.productForm.get("producto"))==null?null:u.invalid)),l(8),s("disabled",e.productForm.invalid||e.isSubmitting),l(),f(" ",e.isSubmitting?"Guardando...":e.isEditMode?"Actualizar Producto":"Guardar Producto"," "),l(),s("ngIf",e.errorMessage)}},dependencies:[_,M,D,R,I,O,y,N,k,F,E],styles:[".form-container[_ngcontent-%COMP%]{padding:1rem;max-width:600px;margin:0 auto}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem}.card[_ngcontent-%COMP%]{background:#fff;padding:2rem;border-radius:8px;box-shadow:0 4px 10px #0000001a}.field[_ngcontent-%COMP%]{margin-bottom:1.5rem;display:flex;flex-direction:column;gap:.4rem}.field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;color:#444}.field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:.75rem;border:1px solid #ddd;border-radius:4px}.field[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:#888;font-size:.8rem}.error[_ngcontent-%COMP%]{color:#d32f2f;font-size:.8rem}.error-box[_ngcontent-%COMP%]{margin-top:1rem;padding:1rem;background:#ffebee;color:#c62828;border-radius:4px}.actions[_ngcontent-%COMP%]{margin-top:2rem}.btn-save[_ngcontent-%COMP%]{width:100%;background:#2196f3;color:#fff;border:none;padding:1rem;border-radius:4px;cursor:pointer;font-weight:600;font-size:1rem}.btn-save[_ngcontent-%COMP%]:disabled{background:#ccc;cursor:not-allowed}.btn-back[_ngcontent-%COMP%]{background:transparent;border:1px solid #ddd;padding:.5rem 1rem;border-radius:4px;cursor:pointer}"]})};export{z as ProductoFormComponent};
