import{a as f,b as h,g as n,h as i,k as s,oa as l,p as d,pa as g,s as u}from"./chunk-7CFEW4HV.js";var c=class e{adaptPedidos(t){return t.data.map(r=>({id:r.id,producto:r.producto,cantidad:r.cantidad,fechaEntrega:new Date(r.fecha),estado:this.mapEstado(r.estado_actual),fechaActualizacion:r.fecha_actualizacion?new Date(r.fecha_actualizacion):void 0}))}adaptStats(t){return t.stats?{totalPendientes:t.stats.pendientes??0,enHorno:t.stats.horno??0,finalizadosHoy:t.stats.finalizados??0}:{totalPendientes:0,enHorno:0,finalizadosHoy:0}}prepareForPost(t){return{producto:t.producto,cantidad:t.cantidad,fechaEntrega:t.fechaEntrega instanceof Date?t.fechaEntrega.toISOString():t.fechaEntrega,estado:t.estado||"Pendiente"}}mapEstado(t){switch(t){case"Pendiente":return"Pendiente";case"En Proceso":return"En Proceso";case"Finalizado":return"Finalizado";default:return"Pendiente"}}static \u0275fac=function(r){return new(r||e)};static \u0275prov=d({token:e,factory:e.\u0275fac,providedIn:"root"})};var m={production:!1,apiUrl:"https://script.google.com/macros/s/AKfycbxj7KRSuyCUFOt1T6NXr5O75ULVgobWRa0c_wg1DSFh-CWfjiS_GiAaJzBzWrOvvZDU/exec"};var E=class e{http=u(g);adapter=u(c);apiUrl=m.apiUrl;getDashboardStats(){return this.http.get(this.apiUrl).pipe(i(t=>{if(t.status==="error")throw new Error(t.message||"Error desconocido en el servidor de datos.");return this.adapter.adaptStats(t)}),s(t=>{console.error("Error fetching production stats:",t);let r=t instanceof Error?t.message:"No se pudo cargar la informaci\xF3n de producci\xF3n. Por favor, compruebe la configuraci\xF3n del script.";return n(()=>new Error(r))}))}getPedidos(){return this.http.get(this.apiUrl).pipe(i(t=>{if(t.status==="error")throw new Error(t.message||"Error al cargar los pedidos.");return this.adapter.adaptPedidos(t)}),s(t=>(console.error("Error fetching pedidos:",t),n(()=>new Error("No se pudieron cargar los pedidos.")))))}addPedido(t){let r=h(f({},this.adapter.prepareForPost(t)),{action:"add"}),p=new l({"Content-Type":"text/plain;charset=utf-8"});return this.http.post(this.apiUrl,JSON.stringify(r),{headers:p}).pipe(i(a=>{if(a.status==="error")throw new Error(a.message||"Error al guardar el pedido.");return a}),s(a=>{console.error("Error adding pedido:",a);let o=a instanceof Error?a.message:"No se pudo guardar el pedido. Por favor, int\xE9ntelo de nuevo.";return n(()=>new Error(o))}))}updatePedidoStatus(t,r){let p={action:"updateStatus",id:t,estado:r},a=new l({"Content-Type":"text/plain;charset=utf-8"});return this.http.post(this.apiUrl,JSON.stringify(p),{headers:a}).pipe(i(o=>{if(o.status==="error")throw new Error(o.message||"Error al actualizar el estado.");return o}),s(o=>(console.error("Error updating status:",o),n(()=>new Error("No se pudo actualizar el estado del pedido.")))))}static \u0275fac=function(r){return new(r||e)};static \u0275prov=d({token:e,factory:e.\u0275fac,providedIn:"root"})};export{E as a};
