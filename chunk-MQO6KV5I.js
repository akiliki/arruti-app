import{a as j}from"./chunk-YS2LZPPF.js";import"./chunk-5CUEJ4WU.js";import{f as $,h as L,i as U,l as H}from"./chunk-ZUEPVTI3.js";import{$a as f,Eb as A,Gb as G,Hb as F,Ia as c,Ib as N,J as y,Jb as R,Kb as V,La as r,Lb as B,Oa as i,Pa as n,Qa as k,Ta as b,U as g,Ua as C,Va as p,Y as T,Za as P,_a as a,ab as m,db as S,ea as x,eb as D,fa as v,fb as _,ga as w,gb as z,hb as O,ib as h,m as E,q as u,w as I,xa as o}from"./chunk-H3YE5RTM.js";var J=t=>["/pedidos/editar",t];function Y(t,d){if(t&1&&(i(0,"div",13)(1,"label"),a(2,"Atendido por"),n(),i(3,"div",14)(4,"span",28),w(),i(5,"svg",29),k(6,"path",30)(7,"circle",31),n(),a(8),n()()()),t&2){let e=p(2).ngIf;o(8),m(" ",e[0].vendedor," ")}}function K(t,d){t&1&&(i(0,"span",40),a(1,"YA EN TIENDA"),n())}function Q(t,d){if(t&1&&(i(0,"span",41),a(1),n()),t&2){let e=p().$implicit;o(),m("Raci\xF3n: ",e.talla,"")}}function W(t,d){if(t&1&&(i(0,"span",42),a(1,"Relleno de: "),i(2,"strong"),a(3),n()()),t&2){let e=p().$implicit;o(3),f(e.relleno)}}function X(t,d){if(t&1&&(i(0,"div",32)(1,"div",33)(2,"span",34),a(3),n(),i(4,"span",35),a(5),n(),c(6,K,2,0,"span",36),n(),i(7,"div",37),c(8,Q,2,1,"span",38)(9,W,4,1,"span",39),n()()),t&2){let e=d.$implicit;o(3),m("",e.cantidad,"x"),o(2),f(e.producto),o(),r("ngIf",e.guardadoEnTienda),o(2),r("ngIf",e.talla),o(),r("ngIf",e.relleno)}}function Z(t,d){if(t&1&&(i(0,"div",43)(1,"label"),a(2,"Notas de Tienda"),n(),i(3,"p"),a(4),n()()),t&2){let e=p(2).ngIf;o(4),f(e[0].notasTienda)}}function ee(t,d){if(t&1&&(i(0,"div",44)(1,"label"),a(2,"Notas de Obrador"),n(),i(3,"p"),a(4),n()()),t&2){let e=p(2).ngIf;o(4),f(e[0].notasPastelero)}}function te(t,d){if(t&1){let e=b();i(0,"button",45),C("click",function(){x(e);let s=p(2).ngIf,M=p();return v(M.markAsDeliveredGroup(s))}),a(1),n()}if(t&2){let e=p(3);r("disabled",e.isUpdating),o(),m(" ",e.isUpdating?"Procesando...":"ENTREGAR TODO EL PEDIDO"," ")}}function ne(t,d){t&1&&(i(0,"div",22)(1,"span",46),a(2,"Entregado correctamente \u2713"),n()())}function ie(t,d){if(t&1&&(i(0,"small"),a(1),_(2,"date"),n()),t&2){let e=p(2).ngIf;o(),m("\xDAltima actualizaci\xF3n: ",O(2,1,e[0].fechaActualizacion,"dd/MM/yyyy HH:mm"),"")}}function oe(t,d){if(t&1&&(i(0,"div",8)(1,"div",9),a(2),n(),i(3,"div",10)(4,"div",11)(5,"label"),a(6,"Cliente"),n(),i(7,"div",12),a(8),n()(),i(9,"div",13)(10,"label"),a(11,"Fecha de Entrega"),n(),i(12,"div",14),a(13),_(14,"date"),n()(),c(15,Y,9,1,"div",15),n(),i(16,"div",16)(17,"h3",17),a(18,"Productos en este pedido"),n(),c(19,X,10,5,"div",18),n(),i(20,"div",19),c(21,Z,5,1,"div",20)(22,ee,5,1,"div",21),n(),i(23,"div",22),c(24,te,2,2,"button",23),i(25,"button",24),a(26," EDITAR PEDIDO "),n()(),c(27,ne,3,0,"div",25),i(28,"div",26)(29,"small"),a(30),n(),c(31,ie,3,4,"small",27),n()()),t&2){let e=p().ngIf;o(),r("ngClass",e[0].estado.toLowerCase().replace(" ","-")),o(),m(" Estado: ",e[0].estado," "),o(6),f(e[0].nombreCliente||"Sin nombre"),o(5),f(O(14,13,e[0].fechaEntrega,"dd/MM/yyyy HH:mm")),o(2),r("ngIf",e[0].vendedor),o(4),r("ngForOf",e),o(2),r("ngIf",e[0].notasTienda),o(),r("ngIf",e[0].notasPastelero),o(2),r("ngIf",e[0].estado!=="Entregado"),o(),r("routerLink",D(16,J,e[0].id)),o(2),r("ngIf",e[0].estado==="Entregado"),o(3),m("ID Grupo: ",e[0].idGrupo||e[0].id,""),o(),r("ngIf",e[0].fechaActualizacion)}}function ae(t,d){t&1&&(i(0,"div",47),a(1,"No se encontr\xF3 el pedido."),n())}function de(t,d){if(t&1&&(i(0,"div",6),c(1,oe,32,18,"div",7)(2,ae,2,0,"ng-template",null,1,h),n()),t&2){let e=d.ngIf,l=P(3);o(),r("ngIf",e.length>0)("ngIfElse",l)}}function re(t,d){t&1&&(i(0,"div",48),a(1,"Cargando detalle del pedido..."),n())}var q=class t{route=g($);router=g(L);productionService=g(j);location=g(A);pedidoGroup$;isUpdating=!1;ngOnInit(){this.pedidoGroup$=this.route.paramMap.pipe(u(d=>d.get("id")),y(d=>d?this.productionService.getPedidos().pipe(u(e=>{let l=e.find(s=>s.id===d);return l?l.idGrupo?e.filter(s=>s.idGrupo===l.idGrupo):[l]:[]})):E([])))}markAsDeliveredGroup(d){if(confirm(`\xBFMarcar como entregados los ${d.length} productos de este pedido?`)){this.isUpdating=!0;let e=d.map(l=>this.productionService.updatePedidoStatus(l.id,"Entregado"));I(e).subscribe({next:()=>{this.isUpdating=!1,this.router.navigate(["/pedidos"])},error:l=>{alert("Error al actualizar: "+l.message),this.isUpdating=!1}})}}goBack(){this.location.back()}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=T({type:t,selectors:[["app-pedido-tienda-detail"]],standalone:!0,features:[S],decls:10,vars:4,consts:[["loading",""],["noOrder",""],[1,"detail-container"],[1,"header"],[1,"btn-back",3,"click"],["class","content",4,"ngIf","ngIfElse"],[1,"content"],["class","card",4,"ngIf","ngIfElse"],[1,"card"],[1,"status-banner",3,"ngClass"],[1,"info-grid"],[1,"info-group","wide"],[1,"value","highlight"],[1,"info-group"],[1,"value"],["class","info-group",4,"ngIf"],[1,"products-list-section"],[1,"section-title"],["class","product-entry",4,"ngFor","ngForOf"],[1,"notes-section"],["class","note-box tienda",4,"ngIf"],["class","note-box pastelero",4,"ngIf"],[1,"actions"],["class","btn-deliver",3,"disabled","click",4,"ngIf"],[1,"btn-edit-secondary",3,"routerLink"],["class","actions",4,"ngIf"],[1,"metadata"],[4,"ngIf"],[1,"vendedor-badge"],["width","14","height","14","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["d","M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"],["cx","12","cy","7","r","4"],[1,"product-entry"],[1,"product-main"],[1,"qty"],[1,"name"],["class","shop-badge",4,"ngIf"],[1,"product-details"],["class","talla",4,"ngIf"],["class","relleno",4,"ngIf"],[1,"shop-badge"],[1,"talla"],[1,"relleno"],[1,"note-box","tienda"],[1,"note-box","pastelero"],[1,"btn-deliver",3,"click","disabled"],[1,"delivery-success"],[1,"error-state"],[1,"loading-state"]],template:function(e,l){if(e&1){let s=b();i(0,"div",2)(1,"div",3)(2,"button",4),C("click",function(){return x(s),v(l.goBack())}),a(3,"\u2190 Volver a Tienda"),n(),i(4,"h2"),a(5,"Detalle del Pedido (Tienda)"),n()(),c(6,de,4,2,"div",5),_(7,"async"),c(8,re,2,0,"ng-template",null,0,h),n()}if(e&2){let s=P(9);o(6),r("ngIf",z(7,2,l.pedidoGroup$))("ngIfElse",s)}},dependencies:[B,G,F,N,R,V,H,U],styles:[".detail-container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:1rem}.header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;margin-bottom:1.5rem}.btn-back[_ngcontent-%COMP%]{background:#eee;border:none;padding:8px 16px;border-radius:8px;cursor:pointer;font-weight:600}.card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;overflow:hidden;box-shadow:0 10px 25px #0000000d;border:1px solid #e2e8f0}.status-banner[_ngcontent-%COMP%]{padding:1rem;text-align:center;font-weight:800;text-transform:uppercase;font-size:1rem;letter-spacing:.5px}.status-banner.pendiente[_ngcontent-%COMP%]{background:#fff7ed;color:#c2410c}.status-banner.en-proceso[_ngcontent-%COMP%]{background:#eff6ff;color:#1d4ed8}.status-banner.producido[_ngcontent-%COMP%]{background:#f0fdf4;color:#15803d}.status-banner.entregado[_ngcontent-%COMP%]{background:#f8fafc;color:#64748b}.info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1.5rem;padding:1.5rem}.info-group.wide[_ngcontent-%COMP%]{grid-column:span 2}.info-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:.75rem;color:#64748b;text-transform:uppercase;font-weight:700;margin-bottom:.25rem}.value[_ngcontent-%COMP%]{font-size:1.1rem;color:#1e293b;font-weight:600}.value.highlight[_ngcontent-%COMP%]{color:#d35400;font-weight:800;font-size:1.5rem}.section-title[_ngcontent-%COMP%]{font-size:.9rem;font-weight:700;color:#64748b;text-transform:uppercase;margin-bottom:1rem}.products-list-section[_ngcontent-%COMP%]{padding:1.5rem;background:#f8fafc;border-top:1px solid #e2e8f0;border-bottom:1px solid #e2e8f0}.product-entry[_ngcontent-%COMP%]{padding:1rem;background:#fff;border:1px solid #e2e8f0;border-radius:12px;margin-bottom:.75rem;box-shadow:0 1px 2px #00000005}.product-main[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;margin-bottom:.25rem}.product-main[_ngcontent-%COMP%]   .qty[_ngcontent-%COMP%]{font-weight:800;color:#d35400;font-size:1.2rem}.product-main[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-weight:700;font-size:1.1rem;color:#0f172a}.shop-badge[_ngcontent-%COMP%]{background:#dcfce7;color:#166534;font-size:.65rem;font-weight:800;padding:2px 6px;border-radius:4px;margin-left:auto;border:1px solid #bbf7d0}.product-details[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem;font-size:.9rem}.product-details[_ngcontent-%COMP%]   .talla[_ngcontent-%COMP%]{background:#f1f5f9;color:#475569;padding:2px 8px;border-radius:6px;font-weight:600}.product-details[_ngcontent-%COMP%]   .relleno[_ngcontent-%COMP%]{color:#d97706}.notes-section[_ngcontent-%COMP%]{padding:1.5rem;display:grid;grid-template-columns:1fr;gap:1rem}@media (min-width: 640px){.notes-section[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}}.note-box[_ngcontent-%COMP%]{padding:1rem;border-radius:12px}.note-box[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.7rem;font-weight:700;text-transform:uppercase;margin-bottom:.5rem;display:block}.note-box[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.95rem;line-height:1.5}.note-box.pastelero[_ngcontent-%COMP%]{background:#fffbeb;border:1px solid #fef3c7;color:#92400e}.note-box.tienda[_ngcontent-%COMP%]{background:#f0f9ff;border:1px solid #e0f2fe;color:#075985}.actions[_ngcontent-%COMP%]{padding:1.5rem;text-align:center;border-top:1px solid #e2e8f0;background:#f8fafc}.btn-deliver[_ngcontent-%COMP%]{background:#059669;color:#fff;border:none;padding:1rem 2rem;border-radius:12px;font-weight:700;font-size:1.1rem;cursor:pointer;transition:all .2s;width:100%;box-shadow:0 4px 6px -1px #05966966}.btn-deliver[_ngcontent-%COMP%]:active{transform:scale(.98)}.btn-deliver[_ngcontent-%COMP%]:disabled{background:#9ca3af;cursor:not-allowed;box-shadow:none}.btn-edit-secondary[_ngcontent-%COMP%]{background:#fff;color:#475569;border:1px solid #e2e8f0;padding:.85rem 2rem;border-radius:12px;font-weight:700;font-size:1rem;cursor:pointer;transition:all .2s;width:100%;margin-top:.75rem}.btn-edit-secondary[_ngcontent-%COMP%]:hover{background:#f8fafc;border-color:#cbd5e1}.delivery-success[_ngcontent-%COMP%]{color:#059669;font-weight:800;font-size:1.25rem}.metadata[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background:#f1f5f9;border-top:1px solid #e2e8f0;display:flex;justify-content:space-between;color:#94a3b8;font-size:.7rem}.vendedor-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;background:#ecfdf5;color:#065f46;padding:4px 12px;border-radius:20px;font-size:.9rem;font-weight:600}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]{text-align:center;padding:4rem;color:#64748b}"]})};export{q as PedidoTiendaDetailComponent};
