import{a as W}from"./chunk-XZOZQMCZ.js";import{a as q,c as G,e as g,h as J,k as K,l as Q,m as U,o as X}from"./chunk-VMF2UI2V.js";import"./chunk-EPLH7U5S.js";import{$ as T,Ba as V,D as r,I as p,J as L,K as d,N as t,O as e,P as u,U as x,V as b,W as n,X as s,Y as _,ba as k,ca as C,d as O,da as $,ea as N,fa as v,h as M,i as I,l as f,la as D,m as y,ma as z,na as R,oa as A,pa as j,qa as B,t as w,u as F,ya as H}from"./chunk-3J4ERITL.js";var re=o=>["/pedidos",o,"estado"];function ae(o,a){if(o&1&&(t(0,"div",24),n(1),e()),o&2){let i=x().$implicit;r(),_("Past: ",i.notasPastelero,"")}}function de(o,a){if(o&1&&(t(0,"div",25),n(1),e()),o&2){let i=x().$implicit;r(),_("Tnd: ",i.notasTienda,"")}}function le(o,a){o&1&&(t(0,"span"),n(1,"-"),e())}function pe(o,a){if(o&1&&(t(0,"tr")(1,"td"),n(2),e(),t(3,"td"),n(4),e(),t(5,"td"),n(6),e(),t(7,"td"),p(8,ae,2,1,"div",19)(9,de,2,1,"div",20)(10,le,2,0,"span",21),e(),t(11,"td"),n(12),e(),t(13,"td"),n(14),C(15,"date"),e(),t(16,"td")(17,"span",22),n(18),e()(),t(19,"td")(20,"button",23),n(21," Cambiar Estado "),e()()()),o&2){let i=a.$implicit;L("data-testid","pedido-row-"+i.id),r(2),s(i.id),r(2),s(i.nombreCliente||"-"),r(2),s(i.producto),r(2),d("ngIf",i.notasPastelero),r(),d("ngIf",i.notasTienda),r(),d("ngIf",!i.notasPastelero&&!i.notasTienda),r(2),s(i.cantidad),r(2),s(N(15,12,i.fechaEntrega,"dd/MM/yyyy HH:mm")),r(3),d("ngClass",i.estado.toLowerCase().replace(" ","-")),r(),_(" ",i.estado," "),r(2),d("routerLink",k(15,re,i.id))}}function se(o,a){if(o&1&&(t(0,"table")(1,"thead")(2,"tr")(3,"th"),n(4,"ID"),e(),t(5,"th"),n(6,"Cliente"),e(),t(7,"th"),n(8,"Producto"),e(),t(9,"th"),n(10,"Notas"),e(),t(11,"th"),n(12,"Cantidad"),e(),t(13,"th"),n(14,"Fecha Entrega"),e(),t(15,"th"),n(16,"Estado"),e(),t(17,"th"),n(18,"Acciones"),e()()(),t(19,"tbody"),p(20,pe,22,17,"tr",18),e()()),o&2){let i=x().ngIf;r(20),d("ngForOf",i)}}function ce(o,a){o&1&&(t(0,"div",26),n(1,"No se encontraron pedidos con los filtros seleccionados."),e())}function me(o,a){if(o&1&&(t(0,"div",16),p(1,se,21,1,"table",17)(2,ce,2,0,"ng-template",null,1,v),e()),o&2){let i=a.ngIf,l=b(3);r(),d("ngIf",i.length>0)("ngIfElse",l)}}function fe(o,a){o&1&&(t(0,"div",27),n(1,"Cargando pedidos..."),e())}var Y=class o{productionService=w(W);estadoFilter=new g("");productoFilter=new g("");fechaFilter=new g("");nombreFilter=new g("");refresh$=new O(void 0);updatingId=null;filteredPedidos$;ngOnInit(){let a=this.refresh$.pipe(y(()=>this.productionService.getPedidos())),i=this.estadoFilter.valueChanges.pipe(f("")),l=this.productoFilter.valueChanges.pipe(f("")),c=this.fechaFilter.valueChanges.pipe(f("")),Z=this.nombreFilter.valueChanges.pipe(f(""));this.filteredPedidos$=I([a,i,l,c,Z]).pipe(M(([ee,h,P,E,S])=>ee.filter(m=>{let te=!h||m.estado===h,ne=!P||m.producto.toLowerCase().includes(P.toLowerCase()),ie=!E||this.formatDate(m.fechaEntrega)===E,oe=!S||m.nombreCliente&&m.nombreCliente.toLowerCase().includes(S.toLowerCase());return te&&ne&&ie&&oe})))}onStatusChange(a,i){let l=i.target.value;this.updatingId=a,this.productionService.updatePedidoStatus(a,l).subscribe({next:()=>{this.updatingId=null,this.refresh$.next()},error:c=>{alert(c.message),this.updatingId=null,this.refresh$.next()}})}formatDate(a){return a.toISOString().split("T")[0]}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=F({type:o,selectors:[["app-pedidos-list"]],standalone:!0,features:[T],decls:35,vars:8,consts:[["loading",""],["empty",""],[1,"list-container"],[1,"header"],["routerLink","/nuevo-pedido",1,"btn-new"],[1,"filters"],[1,"filter-group"],[3,"formControl"],["value",""],["value","Pendiente"],["value","En Proceso"],["value","Finalizado"],["type","text","placeholder","Filtrar por producto...",3,"formControl"],["type","text","placeholder","Filtrar por cliente...",3,"formControl"],["type","date",3,"formControl"],["class","table-wrapper",4,"ngIf","ngIfElse"],[1,"table-wrapper"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],["class","note-tag pastelero",4,"ngIf"],["class","note-tag tienda",4,"ngIf"],[4,"ngIf"],[1,"badge",3,"ngClass"],[1,"btn-action",3,"routerLink"],[1,"note-tag","pastelero"],[1,"note-tag","tienda"],[1,"empty-state"],[1,"loading-state"]],template:function(i,l){if(i&1&&(t(0,"div",2)(1,"div",3)(2,"h2"),n(3,"Lista de Pedidos"),e(),t(4,"button",4),n(5,"Nuevo Pedido"),e()(),t(6,"div",5)(7,"div",6)(8,"label"),n(9,"Estado:"),e(),t(10,"select",7)(11,"option",8),n(12,"Todos"),e(),t(13,"option",9),n(14,"Pendiente"),e(),t(15,"option",10),n(16,"En Proceso"),e(),t(17,"option",11),n(18,"Finalizado"),e()()(),t(19,"div",6)(20,"label"),n(21,"Producto:"),e(),u(22,"input",12),e(),t(23,"div",6)(24,"label"),n(25,"Nombre Cliente:"),e(),u(26,"input",13),e(),t(27,"div",6)(28,"label"),n(29,"Fecha:"),e(),u(30,"input",14),e()(),p(31,me,4,2,"div",15),C(32,"async"),p(33,fe,2,0,"ng-template",null,0,v),e()),i&2){let c=b(34);r(10),d("formControl",l.estadoFilter),r(12),d("formControl",l.productoFilter),r(4),d("formControl",l.nombreFilter),r(4),d("formControl",l.fechaFilter),r(),d("ngIf",$(32,6,l.filteredPedidos$))("ngIfElse",c)}},dependencies:[B,D,z,R,A,j,X,Q,U,q,K,G,J,V,H],styles:[".list-container[_ngcontent-%COMP%]{padding:20px}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.btn-new[_ngcontent-%COMP%]{background:#d35400;color:#fff;border:none;padding:10px 20px;border-radius:4px;cursor:pointer;font-weight:700}.filters[_ngcontent-%COMP%]{display:flex;gap:20px;margin-bottom:20px;background:#f9f9f9;padding:15px;border-radius:8px}.filter-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:5px}.filter-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.9rem;font-weight:700}.filter-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:8px;border:1px solid #ccc;border-radius:4px}.table-wrapper[_ngcontent-%COMP%]{background:#fff;border:1px solid #ddd;border-radius:8px;overflow:hidden}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}th[_ngcontent-%COMP%]{text-align:left;background:#f4f4f4;padding:12px;border-bottom:2px solid #ddd}td[_ngcontent-%COMP%]{padding:12px;border-bottom:1px solid #eee}.timestamp[_ngcontent-%COMP%]{font-size:.8rem;color:#666}.badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:.8rem;font-weight:700}.badge.pendiente[_ngcontent-%COMP%]{background:#fff3cd;color:#856404}.badge.en-proceso[_ngcontent-%COMP%]{background:#cce5ff;color:#004085}.badge.finalizado[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.note-tag[_ngcontent-%COMP%]{font-size:.75rem;padding:2px 5px;border-radius:4px;margin-bottom:2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:150px}.note-tag.pastelero[_ngcontent-%COMP%]{background:#fdf2f2;color:#9b1c1c;border:1px solid #f8d7da}.note-tag.tienda[_ngcontent-%COMP%]{background:#f0f9ff;color:#075985;border:1px solid #bae6fd}.loading-state[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]{padding:40px;text-align:center;color:#666}.btn-action[_ngcontent-%COMP%]{background:#34495e;color:#fff;border:none;padding:6px 12px;border-radius:4px;cursor:pointer;font-size:.85rem}.btn-action[_ngcontent-%COMP%]:hover{background:#2c3e50}"]})};export{Y as PedidosListComponent};
