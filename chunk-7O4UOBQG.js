import{Aa as M,Ba as w,Ca as A,Da as k,E as _,J as l,O as d,Q as P,Sa as z,Ta as F,Ua as H,X as C,Y as S,Ya as j,ja as i,k as v,l as h,o as c,oa as b,pa as s,qa as a,ra as r,sa as E,ta as I,u as p,ua as y,va as O,wa as D,xa as m,ya as o,za as f}from"./chunk-4UXY6HIK.js";var g=class n{adaptPedidos(t){return t.data.map(e=>({id:e.id,producto:e.producto,cantidad:e.cantidad,fechaEntrega:new Date(e.fecha),estado:this.mapEstado(e.estado_actual)}))}adaptStats(t){return t.stats?{totalPendientes:t.stats.pendientes??0,enHorno:t.stats.horno??0,finalizadosHoy:t.stats.finalizados??0}:{totalPendientes:0,enHorno:0,finalizadosHoy:0}}mapEstado(t){switch(t){case"Pendiente":return"Pendiente";case"En Proceso":return"En Proceso";case"Finalizado":return"Finalizado";default:return"Pendiente"}}static \u0275fac=function(e){return new(e||n)};static \u0275prov=l({token:n,factory:n.\u0275fac,providedIn:"root"})};var T={production:!1,apiUrl:"https://script.google.com/macros/s/AKfycbyoAd8pys0n5pgrI9WdC6lmc7XtlGM3NhOwqZvB0IZ_ePtnUMusxXo4NA8AKCrOrd-i/exec"};var u=class n{http=d(j);adapter=d(g);apiUrl=T.apiUrl;getDashboardStats(){return this.http.get(this.apiUrl).pipe(c(t=>{if(t.status==="error")throw new Error(t.message||"Error desconocido en el servidor de datos.");return this.adapter.adaptStats(t)}),p(t=>{console.error("Error fetching production stats:",t);let e=t instanceof Error?t.message:"No se pudo cargar la informaci\xF3n de producci\xF3n. Por favor, compruebe la configuraci\xF3n del script.";return h(()=>new Error(e))}))}static \u0275fac=function(e){return new(e||n)};static \u0275prov=l({token:n,factory:n.\u0275fac,providedIn:"root"})};function V(n,t){n&1&&(a(0,"div",5),E(1,"div",6),a(2,"p"),o(3,"Cargando datos de producci\xF3n..."),r()())}function $(n,t){if(n&1){let e=O();a(0,"div",7),o(1),a(2,"button",8),D("click",function(){C(e);let R=m(2);return S(R.loadStats())}),o(3,"Reintentar"),r()()}if(n&2){let e=m().ngIf;i(),M(" ",e.error," ")}}function B(n,t){if(n&1&&(a(0,"div",9)(1,"div",10)(2,"h3"),o(3,"Pendientes"),r(),a(4,"p",11),o(5),r()(),a(6,"div",10)(7,"h3"),o(8,"En Horno"),r(),a(9,"p",11),o(10),r()(),a(11,"div",10)(12,"h3"),o(13,"Finalizados Hoy"),r(),a(14,"p",11),o(15),r()()()),n&2){let e=m().ngIf;i(5),f(e.data.totalPendientes),i(5),f(e.data.enHorno),i(5),f(e.data.finalizadosHoy)}}function G(n,t){if(n&1&&(I(0),b(1,V,4,0,"div",2)(2,$,4,1,"div",3)(3,B,16,3,"div",4),y()),n&2){let e=t.ngIf;i(),s("ngIf",e.loading),i(),s("ngIf",e.error),i(),s("ngIf",e.data)}}var U=class n{productionService=d(u);state$;ngOnInit(){this.loadStats()}loadStats(){this.state$=this.productionService.getDashboardStats().pipe(c(t=>({loading:!1,data:t,error:null})),_({loading:!0,data:null,error:null}),p(t=>v({loading:!1,data:null,error:t.message})))}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=P({type:n,selectors:[["app-dashboard"]],standalone:!0,features:[w],decls:5,vars:3,consts:[[1,"dashboard-container"],[4,"ngIf"],["class","loading-state",4,"ngIf"],["class","error-state",4,"ngIf"],["class","stats-grid",4,"ngIf"],[1,"loading-state"],[1,"spinner"],[1,"error-state"],[3,"click"],[1,"stats-grid"],[1,"stat-card"],[1,"value"]],template:function(e,x){e&1&&(a(0,"div",0)(1,"h1"),o(2,"Panel de Producci\xF3n - Pasteler\xEDa Arruti"),r(),b(3,G,4,3,"ng-container",1),A(4,"async"),r()),e&2&&(i(3),s("ngIf",k(4,1,x.state$)))},dependencies:[H,z,F],styles:[".dashboard-container[_ngcontent-%COMP%]{padding:20px;font-family:sans-serif}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:20px;margin-top:20px}.stat-card[_ngcontent-%COMP%]{border:1px solid #ddd;padding:15px;border-radius:8px;text-align:center;background:#fff}.value[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:#d35400}.loading-state[_ngcontent-%COMP%]{padding:40px;text-align:center;color:#666}.spinner[_ngcontent-%COMP%]{border:4px solid #f3f3f3;border-top:4px solid #d35400;border-radius:50%;width:30px;height:30px;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 10px}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.error-state[_ngcontent-%COMP%]{padding:20px;text-align:center;color:#721c24;background-color:#f8d7da;border-radius:8px;border:1px solid #f5c6cb;margin-top:20px}button[_ngcontent-%COMP%]{margin-top:10px;padding:8px 16px;cursor:pointer;background:#d35400;color:#fff;border:none;border-radius:4px}button[_ngcontent-%COMP%]:hover{background:#e67e22}"]})};export{U as DashboardComponent};
