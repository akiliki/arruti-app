import{a as Y,b as K}from"./chunk-7KV3VHTG.js";import{a as J}from"./chunk-N5YNCOG6.js";import{a as q}from"./chunk-GBLNJP7S.js";import{a as j}from"./chunk-POPWOB4M.js";import{a as L}from"./chunk-UWCFH2GT.js";import"./chunk-CMYXJOK7.js";import{e as V,g as B,h as $,k as H}from"./chunk-PY7FXQZV.js";import{K as T,Ka as s,Lb as z,Na as c,Nb as A,Ob as G,Pb as F,Qa as o,Ra as n,Sa as P,Tb as N,Ub as R,V as g,Va as h,Wa as O,Wb as U,Xa as l,Z as k,bb as M,cb as d,db as f,eb as m,ga as x,ha as b,hb as S,jb as D,lb as u,m as I,mb as y,nb as E,pb as w,q as v,w as C,za as a}from"./chunk-CMV2EMBO.js";var W=t=>["/pedidos/editar",t];function X(t,i){if(t&1&&(o(0,"div",12)(1,"label"),d(2,"Atendido por"),n(),o(3,"div",13),P(4,"app-vendedor-badge",24),n()()),t&2){let e=l(2).ngIf;a(4),c("vendedor",e[0].vendedor)}}function Z(t,i){t&1&&(o(0,"span",33),d(1,"YA EN TIENDA"),n())}function ee(t,i){if(t&1&&(o(0,"span",34),d(1),n()),t&2){let e=l().$implicit;a(),m("Raci\xF3n: ",e.talla,"")}}function te(t,i){if(t&1&&(o(0,"span",35),d(1,"Relleno de: "),o(2,"strong"),d(3),n()()),t&2){let e=l().$implicit;a(3),f(e.relleno)}}function ne(t,i){if(t&1&&(o(0,"div",25)(1,"div",26)(2,"span",27),d(3),n(),o(4,"span",28),d(5),n(),s(6,Z,2,0,"span",29),n(),o(7,"div",30),s(8,ee,2,1,"span",31)(9,te,4,1,"span",32),n()()),t&2){let e=i.$implicit;a(3),m("",e.cantidad,"x"),a(2),f(e.producto),a(),c("ngIf",e.guardadoEnTienda),a(2),c("ngIf",e.talla),a(),c("ngIf",e.relleno)}}function ie(t,i){t&1&&(o(0,"div",36)(1,"span",37),d(2,"Entregado correctamente \u2713"),n()())}function oe(t,i){if(t&1&&(o(0,"small"),d(1),u(2,"date"),n()),t&2){let e=l(2).ngIf;a(),m("\xDAltima actualizaci\xF3n: ",E(2,1,e[0].fechaActualizacion,"dd/MM/yyyy HH:mm"),"")}}function ae(t,i){if(t&1){let e=h();o(0,"div",7)(1,"div",8),u(2,"pedidoStatusClass"),d(3),n(),o(4,"div",9)(5,"div",10)(6,"label"),d(7,"Cliente"),n(),o(8,"div",11),d(9),n()(),o(10,"div",12)(11,"label"),d(12,"Fecha de Entrega"),n(),o(13,"div",13),d(14),u(15,"date"),n()(),s(16,X,5,1,"div",14),n(),o(17,"div",15)(18,"h3",16),d(19,"Productos en este pedido"),n(),s(20,ne,10,5,"div",17),n(),P(21,"app-pedido-notes",18),o(22,"app-pedido-actions",19),O("deliver",function(){x(e);let p=l().ngIf,_=l();return b(_.markAsDeliveredGroup(p))})("cancel",function(){x(e);let p=l().ngIf,_=l();return b(_.cancelOrderGroup(p))}),o(23,"button",20),d(24," EDITAR PEDIDO "),n()(),s(25,ie,3,0,"div",21),o(26,"div",22)(27,"small"),d(28),n(),s(29,oe,3,4,"small",23),n()()}if(t&2){let e=l().ngIf,r=l();a(),c("ngClass",y(2,14,e[0].estado)),a(2),m(" Estado: ",e[0].estado," "),a(6),f(e[0].nombreCliente||"Sin nombre"),a(5),f(E(15,16,e[0].fechaEntrega,"dd/MM/yyyy HH:mm")),a(2),c("ngIf",e[0].vendedor),a(4),c("ngForOf",e),a(),c("notasTienda",e[0].notasTienda)("notasPastelero",e[0].notasPastelero),a(),c("estado",e[0].estado)("isUpdating",r.isUpdating),a(),c("routerLink",D(19,W,e[0].id)),a(2),c("ngIf",e[0].estado==="Entregado"),a(3),m("ID Grupo: ",e[0].idGrupo||e[0].id,""),a(),c("ngIf",e[0].fechaActualizacion)}}function re(t,i){t&1&&(o(0,"div",38),d(1,"No se encontr\xF3 el pedido."),n())}function de(t,i){if(t&1&&(o(0,"div",5),s(1,ae,30,21,"div",6)(2,re,2,0,"ng-template",null,1,w),n()),t&2){let e=i.ngIf,r=M(3);a(),c("ngIf",e.length>0)("ngIfElse",r)}}function ce(t,i){t&1&&(o(0,"div",39),d(1,"Cargando detalle del pedido..."),n())}var Q=class t{route=g(V);router=g(B);productionService=g(L);location=g(z);pedidoGroup$;isUpdating=!1;ngOnInit(){this.pedidoGroup$=this.route.paramMap.pipe(v(i=>i.get("id")),T(i=>i?this.productionService.getPedidos().pipe(v(e=>{let r=e.find(p=>p.id===i);return r?r.idGrupo?e.filter(p=>p.idGrupo===r.idGrupo):[r]:[]})):I([])))}markAsDeliveredGroup(i){if(confirm(`\xBFMarcar como entregados los ${i.length} productos de este pedido?`)){this.isUpdating=!0;let e=i.map(r=>this.productionService.updatePedidoStatus(r.id,"Entregado"));C(e).subscribe({next:()=>{this.isUpdating=!1,this.router.navigate(["/pedidos"])},error:r=>{alert("Error al actualizar: "+r.message),this.isUpdating=!1}})}}cancelOrderGroup(i){if(confirm(`\xBFEst\xE1s seguro de que deseas CANCELAR este pedido completo (${i.length} productos)?`)){this.isUpdating=!0;let e=i.map(r=>this.productionService.updatePedidoStatus(r.id,"Cancelado"));C(e).subscribe({next:()=>{this.isUpdating=!1,this.router.navigate(["/pedidos"])},error:r=>{alert("Error al cancelar: "+r.message),this.isUpdating=!1}})}}goBack(){this.location.back()}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=k({type:t,selectors:[["app-tienda-pedido-detail"]],standalone:!0,features:[S],decls:6,vars:4,consts:[["loading",""],["noOrder",""],[1,"detail-container"],["title","Detalle del Pedido (Tienda)","backText","\u2190 Volver a Tienda",3,"back"],["class","content",4,"ngIf","ngIfElse"],[1,"content"],["class","card",4,"ngIf","ngIfElse"],[1,"card"],[1,"status-banner",3,"ngClass"],[1,"info-grid"],[1,"info-group","wide"],[1,"value","highlight"],[1,"info-group"],[1,"value"],["class","info-group",4,"ngIf"],[1,"products-list-section"],[1,"section-title"],["class","product-entry",4,"ngFor","ngForOf"],["mode","dual",3,"notasTienda","notasPastelero"],["mode","tienda",3,"deliver","cancel","estado","isUpdating"],[1,"btn-edit-secondary",3,"routerLink"],["class","actions",4,"ngIf"],[1,"metadata"],[4,"ngIf"],[3,"vendedor"],[1,"product-entry"],[1,"product-main"],[1,"qty"],[1,"name"],["class","shop-badge",4,"ngIf"],[1,"product-details"],["class","talla",4,"ngIf"],["class","relleno",4,"ngIf"],[1,"shop-badge"],[1,"talla"],[1,"relleno"],[1,"actions"],[1,"delivery-success"],[1,"error-state"],[1,"loading-state"]],template:function(e,r){if(e&1){let p=h();o(0,"div",2)(1,"app-pedidos-header",3),O("back",function(){return x(p),b(r.goBack())}),n(),s(2,de,4,2,"div",4),u(3,"async"),s(4,ce,2,0,"ng-template",null,0,w),n()}if(e&2){let p=M(5);a(2),c("ngIf",y(3,2,r.pedidoGroup$))("ngIfElse",p)}},dependencies:[U,A,G,F,N,R,H,$,j,J,Y,K,q],styles:[".detail-container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:1rem}.header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;margin-bottom:1.5rem;flex-wrap:wrap}.btn-back[_ngcontent-%COMP%]{background:#eee;border:none;padding:8px 16px;border-radius:8px;cursor:pointer;font-weight:600;min-height:44px}.card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;overflow:hidden;box-shadow:0 10px 25px #0000000d;border:1px solid #e2e8f0}.status-banner[_ngcontent-%COMP%]{padding:1rem;text-align:center;font-weight:800;text-transform:uppercase;font-size:1rem;letter-spacing:.5px}.status-banner.pendiente[_ngcontent-%COMP%]{background:#fff7ed;color:#c2410c}.status-banner.en-proceso[_ngcontent-%COMP%]{background:#eff6ff;color:#1d4ed8}.status-banner.producido[_ngcontent-%COMP%]{background:#f0fdf4;color:#15803d}.status-banner.entregado[_ngcontent-%COMP%]{background:#f8fafc;color:#64748b}.status-banner.cancelado[_ngcontent-%COMP%]{background:#fef2f2;color:#991b1b}.info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1.5rem;padding:1.5rem}.info-group.wide[_ngcontent-%COMP%]{grid-column:span 2}.info-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:.75rem;color:#64748b;text-transform:uppercase;font-weight:700;margin-bottom:.25rem}.value[_ngcontent-%COMP%]{font-size:1.1rem;color:#1e293b;font-weight:600}.value.highlight[_ngcontent-%COMP%]{color:#d35400;font-weight:800;font-size:1.5rem}.section-title[_ngcontent-%COMP%]{font-size:.9rem;font-weight:700;color:#64748b;text-transform:uppercase;margin-bottom:1rem}.products-list-section[_ngcontent-%COMP%]{padding:1.5rem;background:#f8fafc;border-top:1px solid #e2e8f0;border-bottom:1px solid #e2e8f0}.product-entry[_ngcontent-%COMP%]{padding:1rem;background:#fff;border:1px solid #e2e8f0;border-radius:12px;margin-bottom:.75rem;box-shadow:0 1px 2px #00000005}.product-main[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;margin-bottom:.25rem}.product-main[_ngcontent-%COMP%]   .qty[_ngcontent-%COMP%]{font-weight:800;color:#d35400;font-size:1.2rem}.product-main[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-weight:700;font-size:1.1rem;color:#0f172a}.shop-badge[_ngcontent-%COMP%]{background:#dcfce7;color:#166534;font-size:.65rem;font-weight:800;padding:2px 6px;border-radius:4px;margin-left:auto;border:1px solid #bbf7d0}.product-details[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem;font-size:.9rem}.product-details[_ngcontent-%COMP%]   .talla[_ngcontent-%COMP%]{background:#f1f5f9;color:#475569;padding:2px 8px;border-radius:6px;font-weight:600}.product-details[_ngcontent-%COMP%]   .relleno[_ngcontent-%COMP%]{color:#d97706}.notes-section[_ngcontent-%COMP%]{padding:1.5rem;display:grid;grid-template-columns:1fr;gap:1rem}@media (min-width: 640px){.notes-section[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}}.note-box[_ngcontent-%COMP%]{padding:1rem;border-radius:12px}.note-box[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.7rem;font-weight:700;text-transform:uppercase;margin-bottom:.5rem;display:block}.note-box[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.95rem;line-height:1.5}.note-box.pastelero[_ngcontent-%COMP%]{background:#fffbeb;border:1px solid #fef3c7;color:#92400e}.note-box.tienda[_ngcontent-%COMP%]{background:#f0f9ff;border:1px solid #e0f2fe;color:#075985}.actions[_ngcontent-%COMP%]{padding:1.5rem;text-align:center;border-top:1px solid #e2e8f0;background:#f8fafc}.btn-deliver[_ngcontent-%COMP%]{background:#059669;color:#fff;border:none;padding:1rem 2rem;border-radius:12px;font-weight:700;font-size:1.1rem;cursor:pointer;transition:all .2s;width:100%;box-shadow:0 4px 6px -1px #05966966;min-height:44px}.btn-deliver[_ngcontent-%COMP%]:active{transform:scale(.98)}.btn-deliver[_ngcontent-%COMP%]:disabled{background:#9ca3af;cursor:not-allowed;box-shadow:none}.btn-edit-secondary[_ngcontent-%COMP%]{background:#fff;color:#475569;border:1px solid #e2e8f0;padding:.85rem 2rem;border-radius:12px;font-weight:700;font-size:1rem;cursor:pointer;transition:all .2s;width:100%;margin-top:.75rem;min-height:44px}.btn-edit-secondary[_ngcontent-%COMP%]:hover{background:#f8fafc;border-color:#cbd5e1}.btn-cancel-secondary[_ngcontent-%COMP%]{background:#fef2f2;color:#991b1b;border:1px solid #fee2e2;padding:.85rem 2rem;border-radius:12px;font-weight:700;font-size:1rem;cursor:pointer;transition:all .2s;width:100%;margin-top:.75rem;min-height:44px}.btn-cancel-secondary[_ngcontent-%COMP%]:hover{background:#fee2e2}.btn-edit-secondary[_ngcontent-%COMP%]:disabled, .btn-cancel-secondary[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.delivery-success[_ngcontent-%COMP%]{color:#059669;font-weight:800;font-size:1.25rem}.metadata[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background:#f1f5f9;border-top:1px solid #e2e8f0;display:flex;justify-content:space-between;color:#94a3b8;font-size:.7rem}.vendedor-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;background:#ecfdf5;color:#065f46;padding:4px 12px;border-radius:20px;font-size:.9rem;font-weight:600}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]{text-align:center;padding:4rem;color:#64748b}@media (max-width: 768px){.detail-container[_ngcontent-%COMP%]{padding:.75rem}.info-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.info-group.wide[_ngcontent-%COMP%]{grid-column:span 1}.metadata[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem}}"]})};export{Q as TiendaPedidoDetailComponent};
