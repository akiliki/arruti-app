import{a as j}from"./chunk-2DOZQ56E.js";import"./chunk-BKTZ77TT.js";import{f as L,h as $,i as B,l as H}from"./chunk-MLTMCV35.js";import{$a as r,Fb as A,Hb as G,Ib as N,Ja as c,Jb as R,K as y,Kb as F,Lb as V,Ma as l,Mb as U,Pa as i,Qa as n,Ra as w,Ua as b,V as g,Va as v,Wa as s,Z as T,_a as O,ab as f,bb as m,eb as S,fa as u,fb as D,ga as x,gb as C,ha as k,hb as z,ib as E,jb as M,m as I,q as P,w as h,ya as a}from"./chunk-ISGLS2OQ.js";var J=t=>["/pedidos/editar",t];function Y(t,o){if(t&1&&(i(0,"div",13)(1,"label"),r(2,"Atendido por"),n(),i(3,"div",14)(4,"span",29),k(),i(5,"svg",30),w(6,"path",31)(7,"circle",32),n(),r(8),n()()()),t&2){let e=s(2).ngIf;a(8),m(" ",e[0].vendedor," ")}}function K(t,o){t&1&&(i(0,"span",41),r(1,"YA EN TIENDA"),n())}function Q(t,o){if(t&1&&(i(0,"span",42),r(1),n()),t&2){let e=s().$implicit;a(),m("Raci\xF3n: ",e.talla,"")}}function W(t,o){if(t&1&&(i(0,"span",43),r(1,"Relleno de: "),i(2,"strong"),r(3),n()()),t&2){let e=s().$implicit;a(3),f(e.relleno)}}function X(t,o){if(t&1&&(i(0,"div",33)(1,"div",34)(2,"span",35),r(3),n(),i(4,"span",36),r(5),n(),c(6,K,2,0,"span",37),n(),i(7,"div",38),c(8,Q,2,1,"span",39)(9,W,4,1,"span",40),n()()),t&2){let e=o.$implicit;a(3),m("",e.cantidad,"x"),a(2),f(e.producto),a(),l("ngIf",e.guardadoEnTienda),a(2),l("ngIf",e.talla),a(),l("ngIf",e.relleno)}}function Z(t,o){if(t&1&&(i(0,"div",44)(1,"label"),r(2,"Notas de Tienda"),n(),i(3,"p"),r(4),n()()),t&2){let e=s(2).ngIf;a(4),f(e[0].notasTienda)}}function ee(t,o){if(t&1&&(i(0,"div",45)(1,"label"),r(2,"Notas de Obrador"),n(),i(3,"p"),r(4),n()()),t&2){let e=s(2).ngIf;a(4),f(e[0].notasPastelero)}}function te(t,o){if(t&1){let e=b();i(0,"button",46),v("click",function(){u(e);let p=s(2).ngIf,_=s();return x(_.markAsDeliveredGroup(p))}),r(1),n()}if(t&2){let e=s(3);l("disabled",e.isUpdating),a(),m(" ",e.isUpdating?"Procesando...":"ENTREGAR TODO EL PEDIDO"," ")}}function ne(t,o){if(t&1){let e=b();i(0,"button",47),v("click",function(){u(e);let p=s(2).ngIf,_=s();return x(_.cancelOrderGroup(p))}),r(1," CANCELAR PEDIDO "),n()}}function ie(t,o){t&1&&(i(0,"div",22)(1,"span",48),r(2,"Entregado correctamente \u2713"),n()())}function oe(t,o){if(t&1&&(i(0,"small"),r(1),C(2,"date"),n()),t&2){let e=s(2).ngIf;a(),m("\xDAltima actualizaci\xF3n: ",E(2,1,e[0].fechaActualizacion,"dd/MM/yyyy HH:mm"),"")}}function ae(t,o){if(t&1&&(i(0,"div",8)(1,"div",9),r(2),n(),i(3,"div",10)(4,"div",11)(5,"label"),r(6,"Cliente"),n(),i(7,"div",12),r(8),n()(),i(9,"div",13)(10,"label"),r(11,"Fecha de Entrega"),n(),i(12,"div",14),r(13),C(14,"date"),n()(),c(15,Y,9,1,"div",15),n(),i(16,"div",16)(17,"h3",17),r(18,"Productos en este pedido"),n(),c(19,X,10,5,"div",18),n(),i(20,"div",19),c(21,Z,5,1,"div",20)(22,ee,5,1,"div",21),n(),i(23,"div",22),c(24,te,2,2,"button",23),i(25,"button",24),r(26," EDITAR PEDIDO "),n(),c(27,ne,2,0,"button",25),n(),c(28,ie,3,0,"div",26),i(29,"div",27)(30,"small"),r(31),n(),c(32,oe,3,4,"small",28),n()()),t&2){let e=s().ngIf;a(),l("ngClass",e[0].estado.toLowerCase().replace(" ","-")),a(),m(" Estado: ",e[0].estado," "),a(6),f(e[0].nombreCliente||"Sin nombre"),a(5),f(E(14,14,e[0].fechaEntrega,"dd/MM/yyyy HH:mm")),a(2),l("ngIf",e[0].vendedor),a(4),l("ngForOf",e),a(2),l("ngIf",e[0].notasTienda),a(),l("ngIf",e[0].notasPastelero),a(2),l("ngIf",e[0].estado!=="Entregado"),a(),l("routerLink",D(17,J,e[0].id)),a(2),l("ngIf",e[0].estado!=="Cancelado"&&e[0].estado!=="Entregado"),a(),l("ngIf",e[0].estado==="Entregado"),a(3),m("ID Grupo: ",e[0].idGrupo||e[0].id,""),a(),l("ngIf",e[0].fechaActualizacion)}}function re(t,o){t&1&&(i(0,"div",49),r(1,"No se encontr\xF3 el pedido."),n())}function de(t,o){if(t&1&&(i(0,"div",6),c(1,ae,33,19,"div",7)(2,re,2,0,"ng-template",null,1,M),n()),t&2){let e=o.ngIf,d=O(3);a(),l("ngIf",e.length>0)("ngIfElse",d)}}function le(t,o){t&1&&(i(0,"div",50),r(1,"Cargando detalle del pedido..."),n())}var q=class t{route=g(L);router=g($);productionService=g(j);location=g(A);pedidoGroup$;isUpdating=!1;ngOnInit(){this.pedidoGroup$=this.route.paramMap.pipe(P(o=>o.get("id")),y(o=>o?this.productionService.getPedidos().pipe(P(e=>{let d=e.find(p=>p.id===o);return d?d.idGrupo?e.filter(p=>p.idGrupo===d.idGrupo):[d]:[]})):I([])))}markAsDeliveredGroup(o){if(confirm(`\xBFMarcar como entregados los ${o.length} productos de este pedido?`)){this.isUpdating=!0;let e=o.map(d=>this.productionService.updatePedidoStatus(d.id,"Entregado"));h(e).subscribe({next:()=>{this.isUpdating=!1,this.router.navigate(["/pedidos"])},error:d=>{alert("Error al actualizar: "+d.message),this.isUpdating=!1}})}}cancelOrderGroup(o){if(confirm(`\xBFEst\xE1s seguro de que deseas CANCELAR este pedido completo (${o.length} productos)?`)){this.isUpdating=!0;let e=o.map(d=>this.productionService.updatePedidoStatus(d.id,"Cancelado"));h(e).subscribe({next:()=>{this.isUpdating=!1,this.router.navigate(["/pedidos"])},error:d=>{alert("Error al cancelar: "+d.message),this.isUpdating=!1}})}}goBack(){this.location.back()}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=T({type:t,selectors:[["app-pedido-tienda-detail"]],standalone:!0,features:[S],decls:10,vars:4,consts:[["loading",""],["noOrder",""],[1,"detail-container"],[1,"header"],[1,"btn-back",3,"click"],["class","content",4,"ngIf","ngIfElse"],[1,"content"],["class","card",4,"ngIf","ngIfElse"],[1,"card"],[1,"status-banner",3,"ngClass"],[1,"info-grid"],[1,"info-group","wide"],[1,"value","highlight"],[1,"info-group"],[1,"value"],["class","info-group",4,"ngIf"],[1,"products-list-section"],[1,"section-title"],["class","product-entry",4,"ngFor","ngForOf"],[1,"notes-section"],["class","note-box tienda",4,"ngIf"],["class","note-box pastelero",4,"ngIf"],[1,"actions"],["class","btn-deliver",3,"disabled","click",4,"ngIf"],[1,"btn-edit-secondary",3,"routerLink"],["class","btn-cancel-secondary",3,"click",4,"ngIf"],["class","actions",4,"ngIf"],[1,"metadata"],[4,"ngIf"],[1,"vendedor-badge"],["width","14","height","14","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["d","M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"],["cx","12","cy","7","r","4"],[1,"product-entry"],[1,"product-main"],[1,"qty"],[1,"name"],["class","shop-badge",4,"ngIf"],[1,"product-details"],["class","talla",4,"ngIf"],["class","relleno",4,"ngIf"],[1,"shop-badge"],[1,"talla"],[1,"relleno"],[1,"note-box","tienda"],[1,"note-box","pastelero"],[1,"btn-deliver",3,"click","disabled"],[1,"btn-cancel-secondary",3,"click"],[1,"delivery-success"],[1,"error-state"],[1,"loading-state"]],template:function(e,d){if(e&1){let p=b();i(0,"div",2)(1,"div",3)(2,"button",4),v("click",function(){return u(p),x(d.goBack())}),r(3,"\u2190 Volver a Tienda"),n(),i(4,"h2"),r(5,"Detalle del Pedido (Tienda)"),n()(),c(6,de,4,2,"div",5),C(7,"async"),c(8,le,2,0,"ng-template",null,0,M),n()}if(e&2){let p=O(9);a(6),l("ngIf",z(7,2,d.pedidoGroup$))("ngIfElse",p)}},dependencies:[U,G,N,R,F,V,H,B],styles:[".detail-container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:1rem}.header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;margin-bottom:1.5rem}.btn-back[_ngcontent-%COMP%]{background:#eee;border:none;padding:8px 16px;border-radius:8px;cursor:pointer;font-weight:600}.card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;overflow:hidden;box-shadow:0 10px 25px #0000000d;border:1px solid #e2e8f0}.status-banner[_ngcontent-%COMP%]{padding:1rem;text-align:center;font-weight:800;text-transform:uppercase;font-size:1rem;letter-spacing:.5px}.status-banner.pendiente[_ngcontent-%COMP%]{background:#fff7ed;color:#c2410c}.status-banner.en-proceso[_ngcontent-%COMP%]{background:#eff6ff;color:#1d4ed8}.status-banner.producido[_ngcontent-%COMP%]{background:#f0fdf4;color:#15803d}.status-banner.entregado[_ngcontent-%COMP%]{background:#f8fafc;color:#64748b}.status-banner.cancelado[_ngcontent-%COMP%]{background:#fef2f2;color:#991b1b}.info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1.5rem;padding:1.5rem}.info-group.wide[_ngcontent-%COMP%]{grid-column:span 2}.info-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:.75rem;color:#64748b;text-transform:uppercase;font-weight:700;margin-bottom:.25rem}.value[_ngcontent-%COMP%]{font-size:1.1rem;color:#1e293b;font-weight:600}.value.highlight[_ngcontent-%COMP%]{color:#d35400;font-weight:800;font-size:1.5rem}.section-title[_ngcontent-%COMP%]{font-size:.9rem;font-weight:700;color:#64748b;text-transform:uppercase;margin-bottom:1rem}.products-list-section[_ngcontent-%COMP%]{padding:1.5rem;background:#f8fafc;border-top:1px solid #e2e8f0;border-bottom:1px solid #e2e8f0}.product-entry[_ngcontent-%COMP%]{padding:1rem;background:#fff;border:1px solid #e2e8f0;border-radius:12px;margin-bottom:.75rem;box-shadow:0 1px 2px #00000005}.product-main[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;margin-bottom:.25rem}.product-main[_ngcontent-%COMP%]   .qty[_ngcontent-%COMP%]{font-weight:800;color:#d35400;font-size:1.2rem}.product-main[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-weight:700;font-size:1.1rem;color:#0f172a}.shop-badge[_ngcontent-%COMP%]{background:#dcfce7;color:#166534;font-size:.65rem;font-weight:800;padding:2px 6px;border-radius:4px;margin-left:auto;border:1px solid #bbf7d0}.product-details[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem;font-size:.9rem}.product-details[_ngcontent-%COMP%]   .talla[_ngcontent-%COMP%]{background:#f1f5f9;color:#475569;padding:2px 8px;border-radius:6px;font-weight:600}.product-details[_ngcontent-%COMP%]   .relleno[_ngcontent-%COMP%]{color:#d97706}.notes-section[_ngcontent-%COMP%]{padding:1.5rem;display:grid;grid-template-columns:1fr;gap:1rem}@media (min-width: 640px){.notes-section[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}}.note-box[_ngcontent-%COMP%]{padding:1rem;border-radius:12px}.note-box[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.7rem;font-weight:700;text-transform:uppercase;margin-bottom:.5rem;display:block}.note-box[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.95rem;line-height:1.5}.note-box.pastelero[_ngcontent-%COMP%]{background:#fffbeb;border:1px solid #fef3c7;color:#92400e}.note-box.tienda[_ngcontent-%COMP%]{background:#f0f9ff;border:1px solid #e0f2fe;color:#075985}.actions[_ngcontent-%COMP%]{padding:1.5rem;text-align:center;border-top:1px solid #e2e8f0;background:#f8fafc}.btn-deliver[_ngcontent-%COMP%]{background:#059669;color:#fff;border:none;padding:1rem 2rem;border-radius:12px;font-weight:700;font-size:1.1rem;cursor:pointer;transition:all .2s;width:100%;box-shadow:0 4px 6px -1px #05966966}.btn-deliver[_ngcontent-%COMP%]:active{transform:scale(.98)}.btn-deliver[_ngcontent-%COMP%]:disabled{background:#9ca3af;cursor:not-allowed;box-shadow:none}.btn-edit-secondary[_ngcontent-%COMP%]{background:#fff;color:#475569;border:1px solid #e2e8f0;padding:.85rem 2rem;border-radius:12px;font-weight:700;font-size:1rem;cursor:pointer;transition:all .2s;width:100%;margin-top:.75rem}.btn-edit-secondary[_ngcontent-%COMP%]:hover{background:#f8fafc;border-color:#cbd5e1}.btn-cancel-secondary[_ngcontent-%COMP%]{background:#fef2f2;color:#991b1b;border:1px solid #fee2e2;padding:.85rem 2rem;border-radius:12px;font-weight:700;font-size:1rem;cursor:pointer;transition:all .2s;width:100%;margin-top:.75rem}.btn-cancel-secondary[_ngcontent-%COMP%]:hover{background:#fee2e2}.delivery-success[_ngcontent-%COMP%]{color:#059669;font-weight:800;font-size:1.25rem}.metadata[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background:#f1f5f9;border-top:1px solid #e2e8f0;display:flex;justify-content:space-between;color:#94a3b8;font-size:.7rem}.vendedor-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;background:#ecfdf5;color:#065f46;padding:4px 12px;border-radius:20px;font-size:.9rem;font-weight:600}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]{text-align:center;padding:4rem;color:#64748b}"]})};export{q as PedidoTiendaDetailComponent};
