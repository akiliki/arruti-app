import{a as R}from"./chunk-NGKQZP4K.js";import"./chunk-MX345UPI.js";import{e as V,k as B}from"./chunk-PYUXCCWC.js";import{$a as s,Eb as k,Gb as w,Ia as c,Ib as D,J as v,Jb as z,Kb as A,La as r,Lb as N,Oa as n,Pa as t,Ta as C,U as f,Ua as P,Va as l,Y as I,Za as O,_a as o,ab as p,db as y,ea as _,fa as b,fb as u,gb as S,hb as h,ib as T,j as E,q as x,xa as a}from"./chunk-WPZFAPEJ.js";function $(i,d){if(i&1&&(n(0,"div",18)(1,"label"),o(2,"Notas de Tienda"),t(),n(3,"p"),o(4),t()()),i&2){let e=l().ngIf;a(4),s(e.notasTienda)}}function F(i,d){if(i&1&&(n(0,"div",19)(1,"label"),o(2,"Notas de Obrador"),t(),n(3,"p"),o(4),t()()),i&2){let e=l().ngIf;a(4),s(e.notasPastelero)}}function H(i,d){if(i&1){let e=C();n(0,"div",20)(1,"button",21),P("click",function(){_(e);let g=l().ngIf,M=l();return b(M.markAsDelivered(g.id))}),o(2),t()()}if(i&2){let e=l(2);a(),r("disabled",e.isUpdating),a(),p(" ",e.isUpdating?"Procesando...":"ENTREGAR"," ")}}function j(i,d){i&1&&(n(0,"div",20)(1,"span",22),o(2,"Entregado correctamente \u2713"),t()())}function L(i,d){if(i&1&&(n(0,"small"),o(1),u(2,"date"),t()),i&2){let e=l().ngIf;a(),p("\xDAltima actualizaci\xF3n: ",h(2,1,e.fechaActualizacion,"dd/MM/yyyy HH:mm"),"")}}function G(i,d){if(i&1&&(n(0,"div",5)(1,"div",6)(2,"div",7),o(3),t(),n(4,"div",8)(5,"div",9)(6,"label"),o(7,"Cliente"),t(),n(8,"div",10),o(9),t()(),n(10,"div",9)(11,"label"),o(12,"Producto"),t(),n(13,"div",11),o(14),t()(),n(15,"div",9)(16,"label"),o(17,"Cantidad"),t(),n(18,"div",11),o(19),t()(),n(20,"div",9)(21,"label"),o(22,"Fecha de Entrega"),t(),n(23,"div",11),o(24),u(25,"date"),t()()(),n(26,"div",12),c(27,$,5,1,"div",13)(28,F,5,1,"div",14),t(),c(29,H,3,2,"div",15)(30,j,3,0,"div",15),n(31,"div",16)(32,"small"),o(33),t(),c(34,L,3,4,"small",17),t()()()),i&2){let e=d.ngIf;a(2),r("ngClass",e.estado.toLowerCase().replace(" ","-")),a(),p(" Estado: ",e.estado," "),a(6),s(e.nombreCliente||"Sin nombre"),a(5),s(e.producto),a(5),p("",e.cantidad," unidades"),a(5),s(h(25,12,e.fechaEntrega,"dd/MM/yyyy HH:mm")),a(3),r("ngIf",e.notasTienda),a(),r("ngIf",e.notasPastelero),a(),r("ngIf",e.estado!=="Entregado"),a(),r("ngIf",e.estado==="Entregado"),a(3),p("ID: ",e.id,""),a(),r("ngIf",e.fechaActualizacion)}}function q(i,d){i&1&&(n(0,"div",23),o(1,"Cargando detalle del pedido..."),t())}var U=class i{route=f(V);location=f(k);productionService=f(R);refresh$=new E(void 0);pedido$;isUpdating=!1;ngOnInit(){this.pedido$=this.refresh$.pipe(v(()=>this.route.paramMap),x(d=>d.get("id")),v(d=>d?this.productionService.getPedidos().pipe(x(e=>e.find(m=>m.id===d))):[void 0]))}markAsDelivered(d){this.isUpdating=!0,this.productionService.updatePedidoStatus(d,"Entregado").subscribe({next:()=>{this.isUpdating=!1,this.refresh$.next()},error:e=>{alert(e.message),this.isUpdating=!1}})}goBack(){this.location.back()}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=I({type:i,selectors:[["app-pedido-tienda-detail"]],standalone:!0,features:[y],decls:10,vars:4,consts:[["loading",""],[1,"detail-container"],[1,"header"],[1,"btn-back",3,"click"],["class","content",4,"ngIf","ngIfElse"],[1,"content"],[1,"card"],[1,"status-banner",3,"ngClass"],[1,"info-grid"],[1,"info-group"],[1,"value","highlight"],[1,"value"],[1,"notes-section"],["class","note-box tienda",4,"ngIf"],["class","note-box pastelero",4,"ngIf"],["class","actions",4,"ngIf"],[1,"metadata"],[4,"ngIf"],[1,"note-box","tienda"],[1,"note-box","pastelero"],[1,"actions"],[1,"btn-deliver",3,"click","disabled"],[1,"delivery-success"],[1,"loading-state"]],template:function(e,m){if(e&1){let g=C();n(0,"div",1)(1,"div",2)(2,"button",3),P("click",function(){return _(g),b(m.goBack())}),o(3,"\u2190 Volver a Tienda"),t(),n(4,"h2"),o(5,"Detalle del Pedido (Tienda)"),t()(),c(6,G,35,15,"div",4),u(7,"async"),c(8,q,2,0,"ng-template",null,0,T),t()}if(e&2){let g=O(9);a(6),r("ngIf",S(7,2,m.pedido$))("ngIfElse",g)}},dependencies:[N,w,D,z,A,B],styles:[".detail-container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:2rem}.header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:2rem;margin-bottom:2rem}.btn-back[_ngcontent-%COMP%]{background:#eee;border:none;padding:8px 16px;border-radius:4px;cursor:pointer;font-weight:600}.card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 4px 15px #0000001a}.status-banner[_ngcontent-%COMP%]{padding:1rem;text-align:center;font-weight:700;text-transform:uppercase;font-size:1.1rem}.status-banner.pendiente[_ngcontent-%COMP%]{background:#fff3cd;color:#856404}.status-banner.en-proceso[_ngcontent-%COMP%]{background:#cce5ff;color:#004085}.status-banner.producido[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.status-banner.entregado[_ngcontent-%COMP%]{background:#e2e3e5;color:#383d41}.info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:2rem;padding:2rem}.info-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:.8rem;color:#666;text-transform:uppercase;font-weight:700;margin-bottom:.5rem}.value[_ngcontent-%COMP%]{font-size:1.2rem;color:#333}.value.highlight[_ngcontent-%COMP%]{color:#d35400;font-weight:700;font-size:1.5rem}.notes-section[_ngcontent-%COMP%]{padding:0 2rem 2rem;display:flex;flex-direction:column;gap:1rem}.note-box[_ngcontent-%COMP%]{padding:1rem;border-radius:8px}.note-box[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.75rem;font-weight:700;text-transform:uppercase;margin-bottom:.5rem;display:block}.note-box[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:1rem;line-height:1.4}.note-box.pastelero[_ngcontent-%COMP%]{background:#fffde7;border-left:5px solid #fbc02d;color:#856404}.note-box.tienda[_ngcontent-%COMP%]{background:#f0f9ff;border-left:5px solid #0ea5e9;color:#075985}.actions[_ngcontent-%COMP%]{padding:2rem;text-align:center;border-top:1px solid #eee}.btn-deliver[_ngcontent-%COMP%]{background:#27ae60;color:#fff;border:none;padding:15px 30px;border-radius:8px;font-weight:700;font-size:1.1rem;cursor:pointer;width:100%}.btn-deliver[_ngcontent-%COMP%]:disabled{background:#ccc;cursor:not-allowed}.delivery-success[_ngcontent-%COMP%]{color:#27ae60;font-weight:700;font-size:1.2rem}.metadata[_ngcontent-%COMP%]{padding:1rem 2rem;background:#f9f9f9;border-top:1px solid #eee;display:flex;justify-content:space-between;color:#999}.loading-state[_ngcontent-%COMP%]{text-align:center;padding:4rem;color:#666}"]})};export{U as PedidoTiendaDetailComponent};
